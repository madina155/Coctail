import React, {useContext, useEffect, useState} from 'react';
import productImg from "../../assets/blouse01.png"
import productImg2 from "../../assets/blouse01-2.png"
import {useParams} from "react-router-dom"
import {useDispatch, useSelector} from "react-redux";
import {getOneProduct} from "../../redux/reducers/oneProduct";
import {setFavoritesProduct, removeFavoritesProduct, setCartProduct, removeCartProduct} from "../../redux/reducers/products";
import {CustomContext} from "../../utils/context";
import {store} from "../../redux";
import Review from "../Home/Review/Review";

const Product = () => {
        const dispatch = useDispatch()
        const {state} = useContext(CustomContext)
        const params = useParams();
        const {status, error, product} = useSelector((store) => store.oneProduct);
        const {favorites} = useSelector((store) => store.products);
        const [like, setLike] = useState(favorites.find(el => el.id == params.id) ?? false);

        // const {cart} = useSelector((store) => store.product);
        // const [selected, setSelected] = useState(cart.find(el => el.id === params.id) ?? false);

        useEffect(() => {
            dispatch(getOneProduct(params.id))
        }, []);

        const handleLike = () => {
            if (like) {
               dispatch( removeFavoritesProduct(product.id))
                setLike(false)
            } else {
                dispatch(setFavoritesProduct(product.id))
                setLike(true)
            }
        }

        // const handSelected = () => {
        //     if (selected) {
        //         dispatch(removeCartProduct(product.id))
        //         setSelected(false)
        //     } else {
        //         dispatch(setCartProduct(product.id))
        //         setSelected(true)
        //     }
        // }

        return (
            <section className="product">
                <div className="container">
                    <div className="product__titles">
                        <h2 className="product__title">{product.title}</h2>
                        <p className="product__art">Арт 06578990-086</p>
                    </div>
                    <div className="product__row">
                        <div className="product__card">
                            <img className="product__img" src={productImg} alt=""/>
                            <div className="product__photos">
                                <img src={productImg2} alt=""/>
                                <img src={productImg2} alt=""/>
                                <img src={productImg2} alt=""/>
                            </div>
                        </div>
                        <div className="product__card">
                            <p className="product__price">{product.price + " руб."}</p>
                            <p className="product__text">Размер</p>
                            <div className="product__prices">
                                <button className="product__prices-btn">
                                    <p className="product__btn-text">S</p>
                                    <p className="product__btn-size">42</p>
                                </button>
                                <button className="product__prices-btn">
                                    <p className="product__btn-text">M</p>
                                    <p className="product__btn-size">44</p>
                                </button>
                                <button className="product__prices-btn">
                                    <p className="product__btn-text">L</p>
                                    <p className="product__btn-size">46</p>
                                </button>
                                <button className="product__prices-btn">
                                    <p className="product__btn-text">XL</p>
                                    <p className="product__btn-size">48</p>
                                </button>
                            </div>
                            <a className="product__link" href="">Таблица размеров</a>
                            <div className="product__btns">
                                <button className="product__btns-cart">В корзину
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M13.8893 6.66645V5.02756C13.8893 4.51686 13.7887 4.01117 13.5933 3.53935C13.3979 3.06753 13.1114 2.63882 12.7503 2.2777C12.3892 1.91658 11.9605 1.63013 11.4886 1.4347C11.0168 1.23926 10.5111 1.13867 10.0004 1.13867C9.48974 1.13867 8.98404 1.23926 8.51222 1.4347C8.0404 1.63013 7.61169 1.91658 7.25057 2.2777C6.88946 2.63882 6.603 3.06753 6.40757 3.53935C6.21213 4.01117 6.11154 4.51686 6.11154 5.02756V8.91645C6.11154 9.06379 6.17008 9.2051 6.27426 9.30929C6.37845 9.41347 6.51976 9.472 6.6671 9.472C6.81444 9.472 6.95575 9.41347 7.05994 9.30929C7.16412 9.2051 7.22266 9.06379 7.22266 8.91645V7.77756H11.6671V6.66645H7.22266V5.02756C7.22266 4.29085 7.51531 3.58431 8.03625 3.06338C8.55718 2.54244 9.26372 2.24978 10.0004 2.24978C10.7371 2.24978 11.4437 2.54244 11.9646 3.06338C12.4856 3.58431 12.7782 4.29085 12.7782 5.02756V8.88867C12.7782 9.03601 12.8367 9.17732 12.9409 9.28151C13.0451 9.3857 13.1864 9.44423 13.3338 9.44423C13.4811 9.44423 13.6224 9.3857 13.7266 9.28151C13.8308 9.17732 13.8893 9.03601 13.8893 8.88867V7.77756H16.6671V17.7776H3.33377V7.77756H5.00043V6.66645H2.22266V17.8276C2.22266 18.109 2.33445 18.3789 2.53345 18.5779C2.73245 18.7769 3.00234 18.8887 3.28377 18.8887H16.7171C16.9985 18.8887 17.2684 18.7769 17.4674 18.5779C17.6664 18.3789 17.7782 18.109 17.7782 17.8276V6.66645H13.8893Z"
                                            fill="#FFFDF5"/>
                                    </svg>

                                </button>
                                <p className="product__btns-like" onClick={handleLike}>
                                    <svg width="38" height="37" viewBox="0 0 38 37" fill={like ? '#514A7E' : 'none'}
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M18.7797 33.3306C18.5526 33.3299 18.3321 33.254 18.1527 33.1147C12.4383 28.6747 8.50191 24.8514 5.74747 21.0795C2.23247 16.2592 1.4308 11.8089 3.36302 7.85197C4.74025 5.02558 8.69719 2.71308 13.3222 4.05947C15.5273 4.69643 17.4513 6.06239 18.7797 7.93419C20.1081 6.06239 22.0321 4.69643 24.2372 4.05947C28.8519 2.73364 32.8191 5.02558 34.1964 7.85197C36.1286 11.8089 35.3269 16.2592 31.8119 21.0795C29.0575 24.8514 25.1211 28.6747 19.4066 33.1147C19.2272 33.254 19.0068 33.3299 18.7797 33.3306ZM10.6911 5.73475C9.59059 5.69192 8.49921 5.9496 7.5341 6.48014C6.56899 7.01068 5.76659 7.79405 5.21302 8.74614C3.61997 12.0145 4.33941 15.6528 7.41247 19.8564C10.6783 24.0688 14.5025 27.817 18.7797 30.9975C23.0562 27.8201 26.8804 24.0755 30.1469 19.8667C33.2303 15.6528 33.9394 12.0145 32.3464 8.75642C31.3186 6.70086 28.2353 5.06669 24.8025 6.03281C23.7018 6.3581 22.6814 6.91024 21.8069 7.65369C20.9325 8.39714 20.2234 9.31543 19.7252 10.3495C19.6478 10.538 19.5161 10.6992 19.3468 10.8127C19.1775 10.9261 18.9783 10.9867 18.7746 10.9867C18.5708 10.9867 18.3716 10.9261 18.2023 10.8127C18.033 10.6992 17.9013 10.538 17.8239 10.3495C17.3295 9.31285 16.6216 8.39241 15.7466 7.64849C14.8716 6.90458 13.8493 6.35398 12.7466 6.03281C12.0786 5.83876 11.3868 5.73845 10.6911 5.73475Z"
                                            fill="#514A7E"/>
                                    </svg>

                                </p>
                            </div>
                            <div className="product__star">
                                <svg width="140" height="20" viewBox="0 0 140 20" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M108.889 9.32248C109.096 9.16866 109.249 8.95408 109.327 8.70882C109.406 8.46356 109.405 8.19992 109.326 7.95488C109.247 7.70983 109.094 7.49566 108.887 7.3424C108.68 7.18913 108.43 7.10446 108.173 7.10026L103.173 6.91137C103.148 6.90967 103.125 6.9009 103.105 6.88612C103.085 6.87133 103.07 6.85116 103.062 6.82804L101.334 2.16137C101.247 1.92395 101.089 1.71893 100.882 1.57409C100.675 1.42924 100.428 1.35156 100.176 1.35156C99.9228 1.35156 99.6761 1.42924 99.4689 1.57409C99.2617 1.71893 99.104 1.92395 99.0172 2.16137L97.295 6.8447C97.2865 6.86783 97.2715 6.888 97.2518 6.90278C97.232 6.91757 97.2085 6.92634 97.1839 6.92804L92.1839 7.11693C91.9265 7.12113 91.6768 7.2058 91.4699 7.35906C91.263 7.51232 91.1093 7.7265 91.0302 7.97154C90.9512 8.21659 90.9509 8.48023 91.0292 8.72549C91.1076 8.97075 91.2608 9.18533 91.4672 9.33915L95.3895 12.4225C95.4091 12.4379 95.4238 12.4588 95.4317 12.4825C95.4396 12.5062 95.4403 12.5317 95.4339 12.5558L94.0839 17.3391C94.0139 17.5827 94.0207 17.8419 94.1033 18.0815C94.1859 18.3211 94.3403 18.5295 94.5455 18.6782C94.7507 18.8269 94.9967 18.9088 95.2501 18.9128C95.5035 18.9167 95.7519 18.8425 95.9617 18.7003L100.106 15.9225C100.127 15.9084 100.151 15.9008 100.176 15.9008C100.2 15.9008 100.225 15.9084 100.245 15.9225L104.389 18.7003C104.596 18.8474 104.844 18.9264 105.098 18.9264C105.352 18.9264 105.599 18.8474 105.806 18.7003C106.011 18.5529 106.166 18.3456 106.248 18.1068C106.331 17.8681 106.338 17.6096 106.267 17.3669L104.906 12.5669C104.899 12.5428 104.899 12.5171 104.907 12.4932C104.915 12.4694 104.93 12.4485 104.951 12.4336L108.889 9.32248Z"
                                        fill="#514A7E"/>
                                    <path
                                        d="M138.889 9.32248C139.096 9.16866 139.249 8.95408 139.327 8.70882C139.406 8.46356 139.405 8.19992 139.326 7.95488C139.247 7.70983 139.094 7.49566 138.887 7.3424C138.68 7.18913 138.43 7.10446 138.173 7.10026L133.173 6.91137C133.148 6.90967 133.125 6.9009 133.105 6.88612C133.085 6.87133 133.07 6.85116 133.062 6.82804L131.334 2.16137C131.247 1.92395 131.089 1.71893 130.882 1.57409C130.675 1.42924 130.428 1.35156 130.176 1.35156C129.923 1.35156 129.676 1.42924 129.469 1.57409C129.262 1.71893 129.104 1.92395 129.017 2.16137L127.295 6.8447C127.286 6.86783 127.271 6.888 127.252 6.90278C127.232 6.91757 127.208 6.92634 127.184 6.92804L122.184 7.11693C121.926 7.12113 121.677 7.2058 121.47 7.35906C121.263 7.51232 121.109 7.7265 121.03 7.97154C120.951 8.21659 120.951 8.48023 121.029 8.72549C121.108 8.97075 121.261 9.18533 121.467 9.33915L125.389 12.4225C125.409 12.4379 125.424 12.4588 125.432 12.4825C125.44 12.5062 125.44 12.5317 125.434 12.5558L124.084 17.3391C124.014 17.5827 124.021 17.8419 124.103 18.0815C124.186 18.3211 124.34 18.5295 124.545 18.6782C124.751 18.8269 124.997 18.9088 125.25 18.9128C125.503 18.9167 125.752 18.8425 125.962 18.7003L130.106 15.9225C130.127 15.9084 130.151 15.9008 130.176 15.9008C130.2 15.9008 130.225 15.9084 130.245 15.9225L134.389 18.7003C134.596 18.8474 134.844 18.9264 135.098 18.9264C135.352 18.9264 135.599 18.8474 135.806 18.7003C136.011 18.5529 136.166 18.3456 136.248 18.1068C136.331 17.8681 136.338 17.6096 136.267 17.3669L134.906 12.5669C134.899 12.5428 134.899 12.5171 134.907 12.4932C134.915 12.4694 134.93 12.4485 134.951 12.4336L138.889 9.32248Z"
                                        fill="#514A7E"/>
                                    <path
                                        d="M48.8895 9.32248C49.0959 9.16866 49.2491 8.95408 49.3275 8.70882C49.4058 8.46356 49.4055 8.19992 49.3264 7.95488C49.2474 7.70983 49.0937 7.49566 48.8868 7.3424C48.6799 7.18913 48.4302 7.10446 48.1728 7.10026L43.1728 6.91137C43.1482 6.90967 43.1246 6.9009 43.1049 6.88612C43.0852 6.87133 43.0702 6.85116 43.0617 6.82804L41.3339 2.16137C41.2471 1.92395 41.0894 1.71893 40.8822 1.57409C40.675 1.42924 40.4284 1.35156 40.1756 1.35156C39.9228 1.35156 39.6761 1.42924 39.4689 1.57409C39.2617 1.71893 39.104 1.92395 39.0172 2.16137L37.295 6.8447C37.2865 6.86783 37.2715 6.888 37.2518 6.90278C37.232 6.91757 37.2085 6.92634 37.1839 6.92804L32.1839 7.11693C31.9265 7.12113 31.6768 7.2058 31.4699 7.35906C31.263 7.51232 31.1093 7.7265 31.0302 7.97154C30.9512 8.21659 30.9509 8.48023 31.0292 8.72549C31.1076 8.97075 31.2608 9.18533 31.4672 9.33915L35.3895 12.4225C35.4091 12.4379 35.4238 12.4588 35.4317 12.4825C35.4396 12.5062 35.4403 12.5317 35.4339 12.5558L34.0839 17.3391C34.0139 17.5827 34.0207 17.8419 34.1033 18.0815C34.1859 18.3211 34.3403 18.5295 34.5455 18.6782C34.7507 18.8269 34.9967 18.9088 35.2501 18.9128C35.5035 18.9167 35.7519 18.8425 35.9617 18.7003L40.1061 15.9225C40.1265 15.9084 40.1508 15.9008 40.1756 15.9008C40.2004 15.9008 40.2246 15.9084 40.245 15.9225L44.3895 18.7003C44.5963 18.8474 44.8439 18.9264 45.0978 18.9264C45.3517 18.9264 45.5992 18.8474 45.8061 18.7003C46.0114 18.5529 46.1659 18.3456 46.2485 18.1068C46.3311 17.8681 46.3376 17.6096 46.2672 17.3669L44.9061 12.5669C44.8989 12.5428 44.8993 12.5171 44.9073 12.4932C44.9152 12.4694 44.9303 12.4485 44.9506 12.4336L48.8895 9.32248Z"
                                        fill="#514A7E"/>
                                    <path
                                        d="M78.8895 9.32248C79.0959 9.16866 79.2491 8.95408 79.3275 8.70882C79.4058 8.46356 79.4055 8.19992 79.3264 7.95488C79.2474 7.70983 79.0937 7.49566 78.8868 7.3424C78.6799 7.18913 78.4302 7.10446 78.1728 7.10026L73.1728 6.91137C73.1482 6.90967 73.1246 6.9009 73.1049 6.88612C73.0852 6.87133 73.0702 6.85116 73.0617 6.82804L71.3339 2.16137C71.2471 1.92395 71.0894 1.71893 70.8822 1.57409C70.675 1.42924 70.4284 1.35156 70.1756 1.35156C69.9228 1.35156 69.6761 1.42924 69.4689 1.57409C69.2617 1.71893 69.104 1.92395 69.0172 2.16137L67.295 6.8447C67.2865 6.86783 67.2715 6.888 67.2518 6.90278C67.232 6.91757 67.2085 6.92634 67.1839 6.92804L62.1839 7.11693C61.9265 7.12113 61.6768 7.2058 61.4699 7.35906C61.263 7.51232 61.1093 7.7265 61.0302 7.97154C60.9512 8.21659 60.9509 8.48023 61.0292 8.72549C61.1076 8.97075 61.2608 9.18533 61.4672 9.33915L65.3895 12.4225C65.4091 12.4379 65.4238 12.4588 65.4317 12.4825C65.4396 12.5062 65.4403 12.5317 65.4339 12.5558L64.0839 17.3391C64.0139 17.5827 64.0207 17.8419 64.1033 18.0815C64.1859 18.3211 64.3403 18.5295 64.5455 18.6782C64.7507 18.8269 64.9967 18.9088 65.2501 18.9128C65.5035 18.9167 65.7519 18.8425 65.9617 18.7003L70.1061 15.9225C70.1265 15.9084 70.1508 15.9008 70.1756 15.9008C70.2004 15.9008 70.2246 15.9084 70.245 15.9225L74.3895 18.7003C74.5963 18.8474 74.8439 18.9264 75.0978 18.9264C75.3517 18.9264 75.5992 18.8474 75.8061 18.7003C76.0114 18.5529 76.1659 18.3456 76.2485 18.1068C76.3311 17.8681 76.3376 17.6096 76.2672 17.3669L74.9061 12.5669C74.8989 12.5428 74.8993 12.5171 74.9073 12.4932C74.9152 12.4694 74.9303 12.4485 74.9506 12.4336L78.8895 9.32248Z"
                                        fill="#514A7E"/>
                                    <path
                                        d="M18.8895 9.32248C19.0959 9.16866 19.2491 8.95408 19.3275 8.70882C19.4058 8.46356 19.4055 8.19992 19.3264 7.95488C19.2474 7.70983 19.0937 7.49566 18.8868 7.3424C18.6799 7.18913 18.4302 7.10446 18.1728 7.10026L13.1728 6.91137C13.1482 6.90967 13.1246 6.9009 13.1049 6.88612C13.0852 6.87133 13.0702 6.85116 13.0617 6.82804L11.3339 2.16137C11.2471 1.92395 11.0894 1.71893 10.8822 1.57409C10.675 1.42924 10.4284 1.35156 10.1756 1.35156C9.92277 1.35156 9.67608 1.42924 9.46889 1.57409C9.26171 1.71893 9.10404 1.92395 9.01723 2.16137L7.29501 6.8447C7.28649 6.86783 7.27148 6.888 7.25176 6.90278C7.23205 6.91757 7.20848 6.92634 7.1839 6.92804L2.1839 7.11693C1.92645 7.12113 1.67678 7.2058 1.46989 7.35906C1.263 7.51232 1.10926 7.7265 1.03023 7.97154C0.951207 8.21659 0.950852 8.48023 1.02922 8.72549C1.10759 8.97075 1.26075 9.18533 1.46723 9.33915L5.38945 12.4225C5.40908 12.4379 5.42375 12.4588 5.43165 12.4825C5.43955 12.5062 5.44033 12.5317 5.4339 12.5558L4.0839 17.3391C4.01394 17.5827 4.02072 17.8419 4.10331 18.0815C4.1859 18.3211 4.34029 18.5295 4.54548 18.6782C4.75067 18.8269 4.9967 18.9088 5.25009 18.9128C5.50349 18.9167 5.75195 18.8425 5.96167 18.7003L10.1061 15.9225C10.1265 15.9084 10.1508 15.9008 10.1756 15.9008C10.2004 15.9008 10.2246 15.9084 10.245 15.9225L14.3895 18.7003C14.5963 18.8474 14.8439 18.9264 15.0978 18.9264C15.3517 18.9264 15.5992 18.8474 15.8061 18.7003C16.0114 18.5529 16.1659 18.3456 16.2485 18.1068C16.3311 17.8681 16.3376 17.6096 16.2672 17.3669L14.9061 12.5669C14.8989 12.5428 14.8993 12.5171 14.9073 12.4932C14.9152 12.4694 14.9303 12.4485 14.9506 12.4336L18.8895 9.32248Z"
                                        fill="#514A7E"/>
                                </svg>

                            </div>
                            <div className="product__reviews">
                                <a href="">Смотреть все отзывы</a>
                                <a href="">Добавить отзыв</a>
                            </div>
                            <p className="product__description">Описание</p>
                            <p className="product__desc">
                                Здесь будет какое-то неболшое описание о вещи <br/>
                                Здесь будет какое-то неболшое описание о вещи
                            </p>


                        </div>
                    </div>

                    {<Review/>}
                </div>
            </section>
        );
    }
;

export default Product;